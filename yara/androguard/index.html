<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  
  <title>Androguard - Koodous Documentation</title>
  

  <link rel="shortcut icon" href="../../favicon.png">
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../../css/highlight.css">

  
  <script>
    // Current page data
    var mkdocs_page_name = "Androguard";
    var mkdocs_page_input_path = "yara/androguard.md";
    var mkdocs_page_url = "/yara/androguard/";
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js"></script>
  <script src="../../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../../js/highlight.pack.js"></script>
  <script src="../../js/theme.js"></script> 

  
  <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-62062848-2', 'docs.koodous.com');
      ga('send', 'pageview');
  </script>
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> Koodous Documentation</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        <ul class="current">
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../..">Home</a>
        
    </li>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>The Koodous web</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../web/getting-started/">Getting started</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../web/the-repo/">The repository</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>REST API</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../rest-api/getting-started/">Getting started</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>REST API (most used methods)</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../rest-api/apks/">APKs</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../rest-api/apk-download/">APK Download</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../rest-api/apk-upload/">APK Upload</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../rest-api/apk-analysis/">APK Analysis</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../feed/apks/">APKs feed</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../feed/analyses/">Analyses feed</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>REST API (misc methods)</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../rest-api/apk-comments/">APK Comments</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../rest-api/apk-votes/">APK Votes</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../rest-api/analysts/">Analysts</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../rest-api/user_rulesets/">Your Rulesets</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../rest-api/public_rulesets/">Public Rulesets</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../rest-api/public_rulesets_votes/">Public Rulesets Votes</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../rest-api/public_rulesets_comments/">Public Rulesets Comments</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Yara</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../getting-started/">Getting started</a>
        
    </li>

        
            
    <li class="toctree-l1 current">
        <a class="current" href="./">Androguard</a>
        
            <ul>
            
                <li class="toctree-l3"><a href="#introduction">Introduction</a></li>
                
            
                <li class="toctree-l3"><a href="#package-name">Package name</a></li>
                
            
                <li class="toctree-l3"><a href="#app-name">APP name</a></li>
                
            
                <li class="toctree-l3"><a href="#activities">Activities</a></li>
                
            
                <li class="toctree-l3"><a href="#receivers">Receivers</a></li>
                
            
                <li class="toctree-l3"><a href="#permissions">Permissions</a></li>
                
                    <li><a class="toctree-l4" href="#permissions-number">Permissions number</a></li>
                
            
                <li class="toctree-l3"><a href="#services">Services</a></li>
                
            
                <li class="toctree-l3"><a href="#certificate">Certificate</a></li>
                
                    <li><a class="toctree-l4" href="#sha1">SHA1</a></li>
                
                    <li><a class="toctree-l4" href="#issuer">Issuer</a></li>
                
                    <li><a class="toctree-l4" href="#subject">Subject</a></li>
                
            
                <li class="toctree-l3"><a href="#url">URL</a></li>
                
            
                <li class="toctree-l3"><a href="#sdk-versions">SDK versions</a></li>
                
                    <li><a class="toctree-l4" href="#min-sdk">Min SDK</a></li>
                
                    <li><a class="toctree-l4" href="#max-sdk">Max SDK</a></li>
                
                    <li><a class="toctree-l4" href="#target-sdk">Target SDK</a></li>
                
            
            </ul>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../droidbox/">Droidbox</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../file/">File</a>
        
    </li>

        
    </ul>
<li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">Koodous Documentation</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Yara &raquo;</li>
        
      
    
    <li>Androguard</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="introduction">Introduction</h1>
<p>Androguard is a tool to make a static analysis of Android applications. With this module developed to be used with Yara, you can match applications by several criteria based on the static analysis.</p>
<p>First of all, you need to import the module with the next directive at the header of the ruleset.</p>
<pre><code>import &quot;androguard&quot;
</code></pre>

<h1 id="package-name">Package name</h1>
<p>Each Android application has a package name that need to be unique once the application is installed in the mobile phone, but in the wild, we found several applications with the same (or similar) package name. To find this kind of applications, we can use the next condition (we use a complete rule for explain the behaviour):</p>
<pre><code>androguard.package_name(regex)
</code></pre>

<p>And match with a string too...</p>
<pre><code>androguard.package_name(string)
</code></pre>

<pre><code>rule videogames
{
    meta:
        description = &quot;Rule to catch APKs with package name match with videogame&quot;
    condition:
        androguard.package_name(/videogame/)
}
</code></pre>

<p>You can add more restrictions to this rule, like strings, another functions of this module or conditions of another module.</p>
<h1 id="app-name">APP name</h1>
<p>The app name displayed when you install an application in a device could be an indicator of an "anomaly". For this reason, we have an condition to catch this applications. You can match with a regex or with a string.</p>
<pre><code>androguard.app_name(regex)
</code></pre>

<pre><code>androguard.app_name(string)
</code></pre>

<pre><code>rule videogames
{
    meta:
        description = &quot;Rule to catch APKs with app name match with cars&quot;
    condition:
        androguard.app_name(/cars/)
}
</code></pre>

<h1 id="activities">Activities</h1>
<p>The activities is an esential part of the Android applications. They define the "screens" of an application and its logic, so, with the name of that, you can filter some applications. In the next example, we are going to filter applications which the name one of its activity is sms, with a point after and before of that word.</p>
<p>It accepts two formats, with string and with regular expression:</p>
<pre><code>androguard.activity(string)
</code></pre>

<pre><code>androguard.activity(regex)
</code></pre>

<p>And you must use in the conditions section:</p>
<pre><code>rule sendSMS
{
    condition:
        androguard.activity(/\.sms\./) or
        androguard.activity(&quot;com.package.name.sendSMS&quot;)
}
</code></pre>

<p>Of course, this filter does not indicate that the application send SMSs, but maybe receive or use an screen to send some type of SMS.</p>
<h1 id="receivers">Receivers</h1>
<p>To find applications with certain receivers you could use this to match:</p>
<pre><code>androguard.receiver(string)
</code></pre>

<pre><code>androguard.receiver(regex)
</code></pre>

<p>And in a rule, inside condition:</p>
<pre><code>rule sendSMS
{
    condition:
        androguard.receiver(&quot;com.airpush.android.DeliveryReceiver&quot;) or
        androguard.receiver(/smsreceiver/i)
}
</code></pre>

<h1 id="permissions">Permissions</h1>
<p>In order to detect some applications that requires an special or desired permissions, you can use this condition. It find in all permissions of the application and if one of this match with the regular expression, it generates a notification.</p>
<p>The format is the next:</p>
<pre><code>androguard.permission(regex)
</code></pre>

<p>And you must use in the conditions section:</p>
<pre><code>rule videogames
{
    condition:
        androguard.permission(/RESTART_PACKAGES/)
}
</code></pre>

<h2 id="permissions-number">Permissions number</h2>
<p>Some applications with a huge number of permissions could be malware and this variable could help you to detect them.</p>
<pre><code>rule videogames
{
    condition:
        androguard.permissions_number &gt; 5
}
</code></pre>

<h1 id="services">Services</h1>
<p>The service or services of an application are use to run tasks in background. Many times, the malware use this to downloads configuration files, to send stolen data or another thing, ever in background. In order to detect the applications that use an special or desired service name, you can use this condition. It find in all services of the application and if one of this match with the regular expression or an exact string and then generates a notification.</p>
<pre><code>androguard.service(regex)
</code></pre>

<pre><code>androguard.service(string)
</code></pre>

<p>And you must use in the conditions section:</p>
<pre><code>rule videogames
{
    condition:
        androguard.service(&quot;com.example.SendData&quot;) or
        androguard.service(/receivetoken/)
}
</code></pre>

<h1 id="certificate">Certificate</h1>
<p>In our website, one of the details of each APK is the "Developer". If you are a malware analyst, you must know that this field is not easy to know, so we use the APK' certificate to extract it. If you encounter a serie of APKs with the same Developer, you can create a Yara rule to know more of them.</p>
<h3 id="sha1">SHA1</h3>
<p>Each certificate has an SHA1 as a part of its signature, and you can match with it! Some malware developers use the same certificate for many samples, and with this condition you can detect them:</p>
<pre><code>androguard.certificate.sha1(string)
</code></pre>

<p><strong>Remember</strong> that you need to match with the complete sha1, not with a part or regex of it.</p>
<p>Example:</p>
<pre><code>rule videogames: adware
{
    condition:
        androguard.certificate.sha1(&quot;5C88CB801C4FB3D609B57DCD7CAFC25B35E03AC2&quot;) or
        androguard.certificate.sha1(&quot;9E:E0:B6:FD:D1:DC:0A:2B:0C:6B:22:EB:C9:38:4C:A0:DD:05:12:D5&quot;)
        /* Note that accepts two syntax, with and without colons */
}
</code></pre>

<h3 id="issuer">Issuer</h3>
<p>The issuer of a certificate is the person (or entity) that generate the certificate. With the next condition you can match with it:</p>
<pre><code>androguard.certificate.issuer(regex)
</code></pre>

<h3 id="subject">Subject</h3>
<p>The subject of a certificate is the owner of its. To match with this field, you can use:</p>
<pre><code>androguard.certificate.subject(regex)
</code></pre>

<p>NOTE: Normally, Issuer and Subject in an APK' certificates are the same, but this is not a norm.</p>
<h1 id="url">URL</h1>
<p>We perform an static analysis over the APK extracting the <strong>hardcored URLs</strong>. You can do a rule to match with that (using a regex or a string).</p>
<pre><code>androguard.url(regex)
</code></pre>

<pre><code>androguard.url(string)
</code></pre>

<pre><code>rule videogames: adware
{
    condition:
        androguard.url(/adurl\.com/) or
        androguard.url(&quot;google.com&quot;)
}
</code></pre>

<p><strong>NOTE</strong>: Remember that if you want to find a point (.) with a regex, you need to escape it with reverse slash. If you don't do that, it can match with any character.</p>
<h1 id="sdk-versions">SDK versions</h1>
<p>The AndroidManifest.xml file contains the versions minimum, maximum and target that the application requires, specified with the API number.</p>
<p>The API list is the next:</p>
<table>
<thead>
<tr>
<th>Code name</th>
<th align="center">Version</th>
<th>API level</th>
</tr>
</thead>
<tbody>
<tr>
<td>Lollipop</td>
<td align="center">5.0</td>
<td>API level 21</td>
</tr>
<tr>
<td>KitKat</td>
<td align="center">4.4 - 4.4.4</td>
<td>API level 19</td>
</tr>
<tr>
<td>Jelly Bean</td>
<td align="center">4.3.x</td>
<td>API level 18</td>
</tr>
<tr>
<td>Jelly Bean</td>
<td align="center">4.2.x</td>
<td>API level 17</td>
</tr>
<tr>
<td>Jelly Bean</td>
<td align="center">4.1.x</td>
<td>API level 16</td>
</tr>
<tr>
<td>Ice Cream Sandwich</td>
<td align="center">4.0.3 - 4.0.4</td>
<td>API level 15</td>
</tr>
<tr>
<td>Ice Cream Sandwich</td>
<td align="center">4.0.1 - 4.0.2</td>
<td>API level 14</td>
</tr>
<tr>
<td>Honeycomb</td>
<td align="center">3.2.x</td>
<td>API level 13</td>
</tr>
<tr>
<td>Honeycomb</td>
<td align="center">3.1</td>
<td>API level 12</td>
</tr>
<tr>
<td>Honeycomb</td>
<td align="center">3.0</td>
<td>API level 11</td>
</tr>
<tr>
<td>Gingerbread</td>
<td align="center">2.3.3 - 2.3.7</td>
<td>API level 10</td>
</tr>
<tr>
<td>Gingerbread</td>
<td align="center">2.3 - 2.3.2</td>
<td>API level 9</td>
</tr>
<tr>
<td>Froyo</td>
<td align="center">2.2.x</td>
<td>API level 8</td>
</tr>
<tr>
<td>Eclair</td>
<td align="center">2.1</td>
<td>API level 7</td>
</tr>
<tr>
<td>Eclair</td>
<td align="center">2.0.1</td>
<td>API level 6</td>
</tr>
<tr>
<td>Eclair</td>
<td align="center">2.0</td>
<td>API level 5</td>
</tr>
<tr>
<td>Donut</td>
<td align="center">1.6</td>
<td>API level 4</td>
</tr>
<tr>
<td>Cupcake</td>
<td align="center">1.5</td>
<td>API level 3</td>
</tr>
<tr>
<td>(no code name)</td>
<td align="center">1.1</td>
<td>API level 2</td>
</tr>
<tr>
<td>(no code name)</td>
<td align="center">1.0</td>
<td>API level 1</td>
</tr>
</tbody>
</table>
<p>You can see an updated version of this table in its source: <a href="https://source.android.com/source/build-numbers.html">https://source.android.com/source/build-numbers.html</a></p>
<h3 id="min-sdk">Min SDK</h3>
<p>Minimum SDK version specifies that, the minimum version of Android require to execute the application. You can filter that using:</p>
<pre><code>rule videogames: adware
{
    condition:
        androguard.min_sdk == 10 or
        androguard.min_sdk &gt; 10 or
        androguard.min_sdk &lt;= 20 
        //It's only an example, don't bother!
}
</code></pre>

<h3 id="max-sdk">Max SDK</h3>
<p>Maximum SDK specifies the higger version of Android that could run this application:</p>
<pre><code>rule videogames: adware
{
    condition:
        androguard.max_sdk == 18 or
        androguard.max_sdk &gt; 18 or
        androguard.max_sdk &gt;= 19 
}
</code></pre>

<h3 id="target-sdk">Target SDK</h3>
<p>The target version, theorically, specifies in which Android version the application was tested and worked fine.</p>
<pre><code>rule videogames: adware
{
    condition:
        androguard.target_sdk == 14 or
        androguard.target_sdk &gt; 14 or
        androguard.target_sdk &gt;= 15 
}
</code></pre>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../droidbox/" class="btn btn-neutral float-right" title="Droidbox">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../getting-started/" class="btn btn-neutral" title="Getting started"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>

  </div>

<div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../getting-started/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../droidbox/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>

</body>
</html>
